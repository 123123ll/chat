{"remainingRequest":"E:\\Study\\杉达\\Jee项目实践\\大作业\\project\\chat_frontend_vue\\node_modules\\babel-loader\\lib\\index.js!E:\\Study\\杉达\\Jee项目实践\\大作业\\project\\chat_frontend_vue\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!E:\\Study\\杉达\\Jee项目实践\\大作业\\project\\chat_frontend_vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\Study\\杉达\\Jee项目实践\\大作业\\project\\chat_frontend_vue\\src\\components\\FriendChat.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\Study\\杉达\\Jee项目实践\\大作业\\project\\chat_frontend_vue\\src\\components\\FriendChat.vue","mtime":1593585908093},{"path":"E:\\Study\\杉达\\Jee项目实践\\大作业\\project\\chat_frontend_vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\Study\\杉达\\Jee项目实践\\大作业\\project\\chat_frontend_vue\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\Study\\杉达\\Jee项目实践\\大作业\\project\\chat_frontend_vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\Study\\杉达\\Jee项目实践\\大作业\\project\\chat_frontend_vue\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnJlZ2V4cC5leGVjIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLnJlcGxhY2UiOwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwppbXBvcnQgcm91dGVyIGZyb20gIi4uL3JvdXRlciI7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiRnJpZW5kQ2hhdCIsCiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIG1zZ1VzZXJJZDogbnVsbCwKICAgICAgY2hhdE1zZzogbnVsbAogICAgfTsKICB9LAogIG1vdW50ZWQ6IGZ1bmN0aW9uIG1vdW50ZWQoKSB7CiAgICAvLyDliJ3lp4vljJZ3ZWJzb2NrZXQKICAgIGlmICh0eXBlb2YgV2ViU29ja2V0ID09PSAidW5kZWZpbmVkIikgewogICAgICBhbGVydCgi5oKo55qE5rWP6KeI5Zmo5LiN5pSv5oyBV2ViU29ja2V0ISIpOwogICAgfSBlbHNlIHsKICAgICAgdGhpcy5zb2NrZXQgPSBuZXcgV2ViU29ja2V0KCd3czovLzEyNy4wLjAuMTo4MDg4L3dzJyk7CiAgICAgIHRoaXMuc29ja2V0Lm9ub3BlbiA9IHRoaXMub3BlbjsKICAgICAgdGhpcy5zb2NrZXQub25lcnJvciA9IHRoaXMuZXJyb3I7CiAgICAgIHRoaXMuc29ja2V0Lm9ubWVzc2FnZSA9IHRoaXMuZ2V0TWVzc2FnZTsKICAgIH0KCiAgICB0aGlzLnNjcm9sbCgpOwogIH0sCiAgbWV0aG9kczogewogICAgLy8g5a6a5LmJd2Vic29ja2V05Z+656GA5pa55rOVCiAgICBvcGVuOiBmdW5jdGlvbiBvcGVuKCkgewogICAgICBjb25zb2xlLmxvZygiU29ja2V0IGNvbm5lY3RlZCIpOwogICAgICB0aGlzLmluaXQoKTsKICAgIH0sCiAgICBlcnJvcjogZnVuY3Rpb24gZXJyb3IoKSB7CiAgICAgIGNvbnNvbGUubG9nKCJTb2NrZXQgZXJyb3IiKTsKICAgIH0sCiAgICBzZW5kOiBmdW5jdGlvbiBzZW5kKHJlcXVlc3QpIHsKICAgICAgdGhpcy5zb2NrZXQuc2VuZChKU09OLnN0cmluZ2lmeShyZXF1ZXN0KSk7CiAgICB9LAogICAgZ2V0TWVzc2FnZTogZnVuY3Rpb24gZ2V0TWVzc2FnZShyZXNwb25zZSkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgdmFyIGRhdGEgPSBKU09OLnBhcnNlKHJlc3BvbnNlLmRhdGEpOwogICAgICBjb25zb2xlLmxvZyhkYXRhKTsgLy8g6IGK5aSp5raI5oGvCgogICAgICBpZiAoZGF0YS5hY3Rpb24gPT09IDIpIHsKICAgICAgICB2YXIgZGF0ZSA9IG5ldyBEYXRlKCk7CiAgICAgICAgZGF0YS5jaGF0TXNnLnRpbWUgPSBkYXRlLnRvTG9jYWxlU3RyaW5nKCdjaGluZXNlJywgewogICAgICAgICAgaG91cjEyOiBmYWxzZQogICAgICAgIH0pOwogICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgicHVzaFJlY01zZyIsIGRhdGEuY2hhdE1zZyk7CgogICAgICAgIGlmICh0aGlzLiRzdG9yZS5zdGF0ZS5xdWVyeVJlc3VsdC5pZCAhPT0gZGF0YS5pZCkgewogICAgICAgICAgY29uc29sZS5sb2coKTsKICAgICAgICB9CgogICAgICAgIHRoaXMubXNnVXNlcklkID0gZGF0YS5jaGF0TXNnLnNlbmRlcklkOwogICAgICAgIHRoaXMuc2Nyb2xsKCk7CiAgICAgIH0gLy8g5aW95Y+L55Sz6K+3CgoKICAgICAgaWYgKGRhdGEuYWN0aW9uID09PSA5KSB7CiAgICAgICAgdGhpcy5tc2dVc2VySWQgPSAncmVxdWVzdCc7CiAgICAgIH0gLy8g5aW95Y+L55Sz6K+36YCa6L+HCgoKICAgICAgaWYgKGRhdGEuYWN0aW9uID09PSA1KSB7CiAgICAgICAgdGhpcy5heGlvcy5nZXQoIi91c2VyL2ZyaWVuZCIpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgICBfdGhpcy4kc3RvcmUuY29tbWl0KCdzZXRGcmllbmRMaXN0JywgcmVzcG9uc2UuZGF0YSk7CiAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7CiAgICAgICAgICBpZiAoZXJyb3IucmVzcG9uc2Uuc3RhdHVzID09PSA0MDEpIHsKICAgICAgICAgICAgcm91dGVyLnJlcGxhY2UoIi93ZWxjb21lIik7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0sCiAgICBjbG9zZTogZnVuY3Rpb24gY2xvc2UoKSB7CiAgICAgIGNvbnNvbGUubG9nKCJTb2NrZXQgY2xvc2VkIik7CiAgICB9LAogICAgLy8g5Yid5aeL5YyWCiAgICBpbml0OiBmdW5jdGlvbiBpbml0KCkgewogICAgICB2YXIgaW5pdFJlcSA9IHsKICAgICAgICAiYWN0aW9uIjogMSwKICAgICAgICAiY2hhdE1zZyI6IHsKICAgICAgICAgICJzZW5kZXJJZCI6IHRoaXMuJHN0b3JlLnN0YXRlLmN1cnJlbnRVc2VyLmlkCiAgICAgICAgfQogICAgICB9OwogICAgICBpbml0UmVxLmNoYXRNc2cuc2VuZGVySWQgPSB0aGlzLiRzdG9yZS5zdGF0ZS5jdXJyZW50VXNlci5pZDsKICAgICAgdGhpcy5zZW5kKGluaXRSZXEpOwogICAgfSwKICAgIC8vIOWPkemAgea2iOaBrwogICAgc2VuZE1zZzogZnVuY3Rpb24gc2VuZE1zZyhtc2cpIHsKICAgICAgbXNnID0gbXNnLnJlcGxhY2UoJ1xuJywgJycpOwoKICAgICAgaWYgKCFtc2cpIHsKICAgICAgICB0aGlzLmNoYXRNc2cgPSBudWxsOwogICAgICAgIGFsZXJ0KCLlj5HpgIHlhoXlrrnkuI3og73kuLrnqbrvvIzor7fph43mlrDovpPlhaUiKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB2YXIgY2hhdFJlcSA9IHsKICAgICAgICAgIGFjdGlvbjogMiwKICAgICAgICAgIGNoYXRNc2c6IHsKICAgICAgICAgICAgc2VuZGVySWQ6IG51bGwsCiAgICAgICAgICAgIHJlY2VpdmVySWQ6IG51bGwsCiAgICAgICAgICAgIG1zZzogbnVsbAogICAgICAgICAgfQogICAgICAgIH07CiAgICAgICAgY2hhdFJlcS5jaGF0TXNnLnNlbmRlcklkID0gdGhpcy4kc3RvcmUuc3RhdGUuY3VycmVudFVzZXIuaWQ7CiAgICAgICAgY2hhdFJlcS5jaGF0TXNnLm5hbWUgPSB0aGlzLiRzdG9yZS5zdGF0ZS5jdXJyZW50VXNlci5uYW1lOwogICAgICAgIGNoYXRSZXEuY2hhdE1zZy5yZWNlaXZlcklkID0gdGhpcy4kc3RvcmUuc3RhdGUucXVlcnlSZXN1bHQuaWQ7CiAgICAgICAgY2hhdFJlcS5jaGF0TXNnLm1zZyA9IG1zZy5yZXBsYWNlKCdcbicsICcnKTsKICAgICAgICB0aGlzLnNlbmQoY2hhdFJlcSk7IC8vIOaKiuWPkemAgeeahOa2iOaBr+WGmeWFpeWvueivneahhgoKICAgICAgICB2YXIgZGF0ZSA9IG5ldyBEYXRlKCk7CiAgICAgICAgY2hhdFJlcS5jaGF0TXNnLnRpbWUgPSBkYXRlLnRvTG9jYWxlU3RyaW5nKCdjaGluZXNlJywgewogICAgICAgICAgaG91cjEyOiBmYWxzZQogICAgICAgIH0pOwogICAgICAgIGNoYXRSZXEuY2hhdE1zZy5zZW5kZXJOYW1lID0gdGhpcy4kc3RvcmUuc3RhdGUuY3VycmVudFVzZXIubmFtZTsKICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoInB1c2hSZWNNc2ciLCBjaGF0UmVxLmNoYXRNc2cpOwogICAgICAgIHRoaXMuY2hhdE1zZyA9IG51bGw7CiAgICAgICAgdGhpcy5zY3JvbGwoKTsKICAgICAgfQogICAgfSwKICAgIHNjcm9sbDogZnVuY3Rpb24gc2Nyb2xsKCkgewogICAgICB0aGlzLiRuZXh0VGljayhmdW5jdGlvbiAoKSB7CiAgICAgICAgdmFyIG1zZyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzY3JvbGwnKTsKICAgICAgICBtc2cuc2Nyb2xsVG9wID0gbXNnLnNjcm9sbEhlaWdodDsKICAgICAgfSk7CiAgICB9IC8vIGZpbGVVcGxvYWQoZSkgewogICAgLy8gICAgIGxldCBmaWxlID0gZS50YXJnZXQuZmlsZXNbMF07CiAgICAvLyAgICAgbGV0IHBhcmFtID0gbmV3IEZvcm1EYXRhKCk7CiAgICAvLyAgICAgcGFyYW0uYXBwZW5kKCdmaWxlJywgZmlsZSk7CiAgICAvLyAgICAgY29uc29sZS5sb2cocGFyYW0uZ2V0KCdmaWxlJykpOwogICAgLy8gICAgIGxldCBjb25maWcgPSB7CiAgICAvLyAgICAgICAgIGhlYWRlcnM6IHsnQ29udGVudC1UeXBlJzogJ211bHRpcGFydC9mb3JtLWRhdGEnfQogICAgLy8gICAgIH07IC8v5re75Yqg6K+35rGC5aS0CiAgICAvLyAgICAgdGhpcy5heGlvcy5wb3N0KCcvZmlsZS91cCcsIHBhcmFtLCBjb25maWcpCiAgICAvLyAgICAgICAgIC50aGVuKHJlc3BvbnNlID0+IHsKICAgIC8vICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlLmRhdGEpOwogICAgLy8gICAgICAgICB9KQogICAgLy8gfQoKICB9Cn07"},{"version":3,"sources":["FriendChat.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiCA,OAAA,MAAA,MAAA,WAAA;AAEA,eAAA;AACA,EAAA,IAAA,EAAA,YADA;AAEA,EAAA,IAFA,kBAEA;AACA,WAAA;AACA,MAAA,SAAA,EAAA,IADA;AAEA,MAAA,OAAA,EAAA;AAFA,KAAA;AAIA,GAPA;AAQA,EAAA,OARA,qBAQA;AACA;AACA,QAAA,OAAA,SAAA,KAAA,WAAA,EAAA;AACA,MAAA,KAAA,CAAA,oBAAA,CAAA;AACA,KAFA,MAEA;AACA,WAAA,MAAA,GAAA,IAAA,SAAA,CAAA,wBAAA,CAAA;AACA,WAAA,MAAA,CAAA,MAAA,GAAA,KAAA,IAAA;AACA,WAAA,MAAA,CAAA,OAAA,GAAA,KAAA,KAAA;AACA,WAAA,MAAA,CAAA,SAAA,GAAA,KAAA,UAAA;AACA;;AACA,SAAA,MAAA;AACA,GAnBA;AAoBA,EAAA,OAAA,EAAA;AACA;AACA,IAAA,IAFA,kBAEA;AACA,MAAA,OAAA,CAAA,GAAA,CAAA,kBAAA;AACA,WAAA,IAAA;AACA,KALA;AAMA,IAAA,KANA,mBAMA;AACA,MAAA,OAAA,CAAA,GAAA,CAAA,cAAA;AACA,KARA;AASA,IAAA,IATA,gBASA,OATA,EASA;AACA,WAAA,MAAA,CAAA,IAAA,CAAA,IAAA,CAAA,SAAA,CAAA,OAAA,CAAA;AACA,KAXA;AAaA,IAAA,UAbA,sBAaA,QAbA,EAaA;AAAA;;AACA,UAAA,IAAA,GAAA,IAAA,CAAA,KAAA,CAAA,QAAA,CAAA,IAAA,CAAA;AACA,MAAA,OAAA,CAAA,GAAA,CAAA,IAAA,EAFA,CAGA;;AACA,UAAA,IAAA,CAAA,MAAA,KAAA,CAAA,EAAA;AACA,YAAA,IAAA,GAAA,IAAA,IAAA,EAAA;AACA,QAAA,IAAA,CAAA,OAAA,CAAA,IAAA,GAAA,IAAA,CAAA,cAAA,CAAA,SAAA,EAAA;AAAA,UAAA,MAAA,EAAA;AAAA,SAAA,CAAA;AACA,aAAA,MAAA,CAAA,MAAA,CAAA,YAAA,EAAA,IAAA,CAAA,OAAA;;AACA,YAAA,KAAA,MAAA,CAAA,KAAA,CAAA,WAAA,CAAA,EAAA,KAAA,IAAA,CAAA,EAAA,EAAA;AACA,UAAA,OAAA,CAAA,GAAA;AACA;;AACA,aAAA,SAAA,GAAA,IAAA,CAAA,OAAA,CAAA,QAAA;AACA,aAAA,MAAA;AACA,OAbA,CAcA;;;AACA,UAAA,IAAA,CAAA,MAAA,KAAA,CAAA,EAAA;AACA,aAAA,SAAA,GAAA,SAAA;AACA,OAjBA,CAkBA;;;AACA,UAAA,IAAA,CAAA,MAAA,KAAA,CAAA,EAAA;AACA,aAAA,KAAA,CAAA,GAAA,CAAA,cAAA,EAAA,IAAA,CAAA,UAAA,QAAA,EAAA;AACA,UAAA,KAAA,CAAA,MAAA,CAAA,MAAA,CAAA,eAAA,EAAA,QAAA,CAAA,IAAA;AACA,SAFA,EAEA,KAFA,CAEA,UAAA,KAAA,EAAA;AACA,cAAA,KAAA,CAAA,QAAA,CAAA,MAAA,KAAA,GAAA,EAAA;AACA,YAAA,MAAA,CAAA,OAAA,CAAA,UAAA;AACA;AACA,SANA;AAOA;AACA,KAzCA;AA0CA,IAAA,KA1CA,mBA0CA;AACA,MAAA,OAAA,CAAA,GAAA,CAAA,eAAA;AACA,KA5CA;AA6CA;AACA,IAAA,IA9CA,kBA8CA;AACA,UAAA,OAAA,GAAA;AACA,kBAAA,CADA;AAEA,mBAAA;AACA,sBAAA,KAAA,MAAA,CAAA,KAAA,CAAA,WAAA,CAAA;AADA;AAFA,OAAA;AAMA,MAAA,OAAA,CAAA,OAAA,CAAA,QAAA,GAAA,KAAA,MAAA,CAAA,KAAA,CAAA,WAAA,CAAA,EAAA;AACA,WAAA,IAAA,CAAA,OAAA;AACA,KAvDA;AAwDA;AACA,IAAA,OAzDA,mBAyDA,GAzDA,EAyDA;AACA,MAAA,GAAA,GAAA,GAAA,CAAA,OAAA,CAAA,IAAA,EAAA,EAAA,CAAA;;AACA,UAAA,CAAA,GAAA,EAAA;AACA,aAAA,OAAA,GAAA,IAAA;AACA,QAAA,KAAA,CAAA,gBAAA,CAAA;AACA,OAHA,MAGA;AACA,YAAA,OAAA,GAAA;AACA,UAAA,MAAA,EAAA,CADA;AAEA,UAAA,OAAA,EAAA;AACA,YAAA,QAAA,EAAA,IADA;AAEA,YAAA,UAAA,EAAA,IAFA;AAGA,YAAA,GAAA,EAAA;AAHA;AAFA,SAAA;AAQA,QAAA,OAAA,CAAA,OAAA,CAAA,QAAA,GAAA,KAAA,MAAA,CAAA,KAAA,CAAA,WAAA,CAAA,EAAA;AACA,QAAA,OAAA,CAAA,OAAA,CAAA,IAAA,GAAA,KAAA,MAAA,CAAA,KAAA,CAAA,WAAA,CAAA,IAAA;AACA,QAAA,OAAA,CAAA,OAAA,CAAA,UAAA,GAAA,KAAA,MAAA,CAAA,KAAA,CAAA,WAAA,CAAA,EAAA;AACA,QAAA,OAAA,CAAA,OAAA,CAAA,GAAA,GAAA,GAAA,CAAA,OAAA,CAAA,IAAA,EAAA,EAAA,CAAA;AACA,aAAA,IAAA,CAAA,OAAA,EAbA,CAcA;;AACA,YAAA,IAAA,GAAA,IAAA,IAAA,EAAA;AACA,QAAA,OAAA,CAAA,OAAA,CAAA,IAAA,GAAA,IAAA,CAAA,cAAA,CAAA,SAAA,EAAA;AAAA,UAAA,MAAA,EAAA;AAAA,SAAA,CAAA;AACA,QAAA,OAAA,CAAA,OAAA,CAAA,UAAA,GAAA,KAAA,MAAA,CAAA,KAAA,CAAA,WAAA,CAAA,IAAA;AACA,aAAA,MAAA,CAAA,MAAA,CAAA,YAAA,EAAA,OAAA,CAAA,OAAA;AACA,aAAA,OAAA,GAAA,IAAA;AACA,aAAA,MAAA;AACA;AACA,KApFA;AAqFA,IAAA,MArFA,oBAqFA;AACA,WAAA,SAAA,CAAA,YAAA;AACA,YAAA,GAAA,GAAA,QAAA,CAAA,cAAA,CAAA,QAAA,CAAA;AACA,QAAA,GAAA,CAAA,SAAA,GAAA,GAAA,CAAA,YAAA;AACA,OAHA;AAIA,KA1FA,CA2FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAvGA;AApBA,CAAA","sourcesContent":["<template>\r\n    <div class=\"content\">\r\n        <div class=\"header\">\r\n            <div class=\"backButton\" @click=\"$router.push('/main')\">< Back</div>\r\n            <div class=\"title\">\r\n                <span @click=\"$router.push('/main/friendInfo')\">{{$store.state.queryResult.name}}</span>\r\n            </div>\r\n        </div>\r\n        <div class=\"msg\">\r\n            <div class=\"msgBox\" id=\"scroll\">\r\n                <div class=\"msgRow\" v-for=\"msg in $store.state.recMsg\"\r\n                     v-if=\"msg.senderId===$store.state.queryResult.id || (msg.senderId === $store.state.currentUser.id && msg.receiverId === $store.state.queryResult.id)\">\r\n                    <span class=\"senderName\">{{msg.name}}</span>\r\n                    <span class=\"receiveTime\">{{msg.time}}</span>\r\n                    <br>\r\n                    <span class=\"msgContent\">{{msg.msg}}</span>\r\n                </div>\r\n            </div>\r\n            <div class=\"inputBox\">\r\n                <div class=\"toolBar\">\r\n                    <div class=\"tool\" @click=\"$router.push('/main/friendmsglog')\">聊天记录</div>\r\n                </div>\r\n                <textarea class=\"textarea\" v-model=\"chatMsg\" @keyup.enter=\"sendMsg(chatMsg)\">\r\n            </textarea>\r\n                <div class=\"bottomBar\">\r\n                    <div class=\"sendButton\" @click=\"sendMsg(chatMsg)\">发送</div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n    import router from \"../router\";\r\n\r\n    export default {\r\n        name: \"FriendChat\",\r\n        data() {\r\n            return {\r\n                msgUserId: null,\r\n                chatMsg: null,\r\n            }\r\n        },\r\n        mounted() {\r\n            // 初始化websocket\r\n            if (typeof (WebSocket) === \"undefined\") {\r\n                alert(\"您的浏览器不支持WebSocket!\")\r\n            } else {\r\n                this.socket = new WebSocket('ws://127.0.0.1:8088/ws')\r\n                this.socket.onopen = this.open\r\n                this.socket.onerror = this.error\r\n                this.socket.onmessage = this.getMessage\r\n            }\r\n            this.scroll();\r\n        },\r\n        methods: {\r\n            // 定义websocket基础方法\r\n            open() {\r\n                console.log(\"Socket connected\");\r\n                this.init();\r\n            },\r\n            error() {\r\n                console.log(\"Socket error\")\r\n            },\r\n            send(request) {\r\n                this.socket.send(JSON.stringify(request));\r\n            },\r\n\r\n            getMessage(response) {\r\n                let data = JSON.parse(response.data);\r\n                console.log(data);\r\n                // 聊天消息\r\n                if (data.action === 2) {\r\n                    let date = new Date();\r\n                    data.chatMsg.time = date.toLocaleString('chinese', {hour12: false});\r\n                    this.$store.commit(\"pushRecMsg\", data.chatMsg);\r\n                    if (this.$store.state.queryResult.id !== data.id) {\r\n                        console.log();\r\n                    }\r\n                    this.msgUserId = data.chatMsg.senderId;\r\n                    this.scroll();\r\n                }\r\n                // 好友申请\r\n                if (data.action === 9) {\r\n                    this.msgUserId = 'request'\r\n                }\r\n                // 好友申请通过\r\n                if (data.action === 5) {\r\n                    this.axios.get(\"/user/friend\").then(response => {\r\n                        this.$store.commit('setFriendList', response.data);\r\n                    }).catch((error) => {\r\n                        if (error.response.status === 401) {\r\n                            router.replace(\"/welcome\")\r\n                        }\r\n                    });\r\n                }\r\n            },\r\n            close() {\r\n                console.log(\"Socket closed\")\r\n            },\r\n            // 初始化\r\n            init() {\r\n                let initReq = {\r\n                    \"action\": 1,\r\n                    \"chatMsg\": {\r\n                        \"senderId\": this.$store.state.currentUser.id\r\n                    }\r\n                };\r\n                initReq.chatMsg.senderId = this.$store.state.currentUser.id;\r\n                this.send(initReq)\r\n            },\r\n            // 发送消息\r\n            sendMsg(msg) {\r\n                msg = msg.replace('\\n', '');\r\n                if (!msg) {\r\n                    this.chatMsg = null;\r\n                    alert(\"发送内容不能为空，请重新输入\")\r\n                } else {\r\n                    let chatReq = {\r\n                        action: 2,\r\n                        chatMsg: {\r\n                            senderId: null,\r\n                            receiverId: null,\r\n                            msg: null\r\n                        }\r\n                    };\r\n                    chatReq.chatMsg.senderId = this.$store.state.currentUser.id;\r\n                    chatReq.chatMsg.name = this.$store.state.currentUser.name;\r\n                    chatReq.chatMsg.receiverId = this.$store.state.queryResult.id;\r\n                    chatReq.chatMsg.msg = msg.replace('\\n', '');\r\n                    this.send(chatReq);\r\n                    // 把发送的消息写入对话框\r\n                    let date = new Date();\r\n                    chatReq.chatMsg.time = date.toLocaleString('chinese', {hour12: false});\r\n                    chatReq.chatMsg.senderName = this.$store.state.currentUser.name;\r\n                    this.$store.commit(\"pushRecMsg\", chatReq.chatMsg);\r\n                    this.chatMsg = null;\r\n                    this.scroll();\r\n                }\r\n            },\r\n            scroll() {\r\n                this.$nextTick(() => {\r\n                    let msg = document.getElementById('scroll');\r\n                    msg.scrollTop = msg.scrollHeight\r\n                })\r\n            },\r\n            // fileUpload(e) {\r\n            //     let file = e.target.files[0];\r\n            //     let param = new FormData();\r\n            //     param.append('file', file);\r\n            //     console.log(param.get('file'));\r\n            //     let config = {\r\n            //         headers: {'Content-Type': 'multipart/form-data'}\r\n            //     }; //添加请求头\r\n            //     this.axios.post('/file/up', param, config)\r\n            //         .then(response => {\r\n            //             console.log(response.data);\r\n            //         })\r\n            // }\r\n        }\r\n    }\r\n</script>\r\n\r\n<style scoped>\r\n    .content {\r\n        padding: 25px;\r\n        height: 100%;\r\n        box-sizing: border-box;\r\n        overflow: hidden;\r\n    }\r\n\r\n    .header {\r\n        position: absolute;\r\n        width: 650px;\r\n        height: 60px;\r\n        border-bottom: 1px solid #CCCCCC;\r\n        text-align: right;\r\n    }\r\n\r\n    .title {\r\n        height: 100%;\r\n        font-size: 24px;\r\n        font-weight: bolder;\r\n        text-align: center;\r\n        line-height: 70px;\r\n    }\r\n\r\n    .title > span {\r\n        cursor: pointer;\r\n    }\r\n\r\n    .backButton {\r\n        position: absolute;\r\n        cursor: pointer;\r\n        font-size: 20px;\r\n        color: #888888;\r\n    }\r\n\r\n    .toolBar {\r\n        width: 100%;\r\n        height: 30px;\r\n    }\r\n\r\n    .textarea {\r\n        width: 644px;\r\n        height: 80%;\r\n        padding: 5px;\r\n        outline: none;\r\n        resize: none;\r\n        border: none;\r\n        background: #EEEEEE;\r\n        font-size: 20px;\r\n        font-family: Arial, serif;\r\n    }\r\n\r\n    .bottomBar {\r\n        text-align: right;\r\n    }\r\n\r\n    .bottomBar > span {\r\n        color: #888888;\r\n        font-size: 10px;\r\n        margin-right: 20px;\r\n\r\n    }\r\n\r\n    .sendButton {\r\n        display: inline-block;\r\n        border: 1px solid #c1c1c1;\r\n        text-decoration: none;\r\n        background-color: #fff;\r\n        color: #222;\r\n        border-radius: 4px;\r\n        padding: 3px 30px;\r\n        font-size: 14px;\r\n        cursor: pointer;\r\n        user-select: none;\r\n    }\r\n\r\n    .sendButton:hover {\r\n        background-color: #d8d8d8;\r\n    }\r\n\r\n    .senderName {\r\n        margin-right: 20px;\r\n        font-weight: bold;\r\n    }\r\n\r\n    .msgContent {\r\n        word-wrap: normal;\r\n    }\r\n\r\n    .msgRow {\r\n        padding: 5px;\r\n        border-bottom: 1px solid #c1c1c1;\r\n        line-height: 25px;\r\n    }\r\n\r\n    .msgRow:last-child {\r\n        border: none;\r\n    }\r\n\r\n    .receiveTime {\r\n        float: right;\r\n    }\r\n\r\n    .msg {\r\n        height: 100%;\r\n        box-sizing: border-box;\r\n    }\r\n\r\n    .msgBox {\r\n        height: 70%;\r\n        overflow-y: scroll;\r\n        margin-top: 60px;\r\n    }\r\n\r\n    .inputBox {\r\n        width: 650px;\r\n        height: 25%;\r\n        border-top: 1px solid #CCCCCC;\r\n    }\r\n\r\n    .tool {\r\n        width: 80px;\r\n        height: 30px;\r\n        line-height: 30px;\r\n        text-align: center;\r\n        cursor: pointer;\r\n        border-right: 1px solid #CCCCCC;\r\n    }\r\n    .toolBar{\r\n        border-bottom: 1px solid #CCCCCC;\r\n        height: 30px;\r\n    }\r\n</style>"],"sourceRoot":"src/components"}]}