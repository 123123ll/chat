{"remainingRequest":"E:\\Study\\杉达\\Jee项目实践\\大作业\\project\\chat_frontend_vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\Study\\杉达\\Jee项目实践\\大作业\\project\\chat_frontend_vue\\src\\components\\FriendChat.vue?vue&type=style&index=0&id=be9c8f32&scoped=true&lang=css&","dependencies":[{"path":"E:\\Study\\杉达\\Jee项目实践\\大作业\\project\\chat_frontend_vue\\src\\components\\FriendChat.vue","mtime":1593001185530},{"path":"E:\\Study\\杉达\\Jee项目实践\\大作业\\project\\chat_frontend_vue\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\Study\\杉达\\Jee项目实践\\大作业\\project\\chat_frontend_vue\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"E:\\Study\\杉达\\Jee项目实践\\大作业\\project\\chat_frontend_vue\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"E:\\Study\\杉达\\Jee项目实践\\大作业\\project\\chat_frontend_vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\Study\\杉达\\Jee项目实践\\大作业\\project\\chat_frontend_vue\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgouY29udGVudCB7CiAgICBwYWRkaW5nOiAyNXB4Owp9CgouaGVhZGVyIHsKICAgIHdpZHRoOiAxMDAlOwogICAgaGVpZ2h0OiA2MHB4OwogICAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkICNDQ0NDQ0M7CiAgICB0ZXh0LWFsaWduOiByaWdodDsKfQoKLnRpdGxlIHsKICAgIGhlaWdodDogMTAwJTsKICAgIHBhZGRpbmctcmlnaHQ6IDIwcHg7CiAgICBmb250LXNpemU6IDI0cHg7CiAgICBmb250LXdlaWdodDogYm9sZGVyOwogICAgdGV4dC1hbGlnbjogY2VudGVyOwogICAgbGluZS1oZWlnaHQ6IDcwcHg7Cn0KCi50aXRsZSA+IHNwYW4gewogICAgY3Vyc29yOiBwb2ludGVyOwp9CgouYmFja0J1dHRvbiB7CiAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICBmb250LXNpemU6IDIwcHg7CiAgICBjb2xvcjogIzg4ODg4ODsKfQoKCi5pbnB1dEJveCB7CiAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICBib3R0b206IDA7CiAgICB3aWR0aDogNjUwcHg7CiAgICBoZWlnaHQ6IDMwMHB4OwogICAgYm9yZGVyLXRvcDogMXB4IHNvbGlkICNDQ0NDQ0M7Cn0KCi50b29sQmFyIHsKICAgIHdpZHRoOiAxMDAlOwogICAgaGVpZ2h0OiAzMHB4Owp9CgoudGV4dGFyZWEgewogICAgd2lkdGg6IDY0NHB4OwogICAgaGVpZ2h0OiAyMjBweDsKICAgIHBhZGRpbmc6IDVweDsKICAgIG91dGxpbmU6IG5vbmU7CiAgICByZXNpemU6IG5vbmU7CiAgICBib3JkZXI6IG5vbmU7CiAgICBiYWNrZ3JvdW5kOiAjRUVFRUVFOwogICAgZm9udC1zaXplOiAyMHB4OwogICAgZm9udC1mYW1pbHk6IEFyaWFsOwp9CgouYm90dG9tQmFyIHsKICAgIHRleHQtYWxpZ246IHJpZ2h0Owp9CgouYm90dG9tQmFyID4gc3BhbiB7CiAgICBjb2xvcjogIzg4ODg4ODsKICAgIGZvbnQtc2l6ZTogMTBweDsKICAgIG1hcmdpbi1yaWdodDogMjBweDsKCn0KCi5zZW5kQnV0dG9uIHsKICAgIGRpc3BsYXk6IGlubGluZS1ibG9jazsKICAgIGJvcmRlcjogMXB4IHNvbGlkICNjMWMxYzE7CiAgICB0ZXh0LWRlY29yYXRpb246IG5vbmU7CiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZmZmOwogICAgY29sb3I6ICMyMjI7CiAgICBib3JkZXItcmFkaXVzOiA0cHg7CiAgICBwYWRkaW5nOiAzcHggMzBweDsKICAgIGZvbnQtc2l6ZTogMTRweDsKICAgIGN1cnNvcjogcG9pbnRlcjsKICAgIHVzZXItc2VsZWN0OiBub25lOwp9Cgouc2VuZEJ1dHRvbjpob3ZlciB7CiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZDhkOGQ4Owp9Cgouc2VuZGVyTmFtZSB7CiAgICBtYXJnaW4tcmlnaHQ6IDIwcHg7Cn0KCi5tc2dDb250ZW50IHsKICAgIHdvcmQtd3JhcDogYnJlYWstd29yZDsKICAgIHdvcmQtYnJlYWs6IGJyZWFrLWFsbDsKICAgIHBhZGRpbmctbGVmdDogMTBweDsKfQoKLm1zZ1JvdyB7CiAgICBwYWRkaW5nOiA1cHg7CiAgICBib3JkZXItYm90dG9tOiAxcHggc29saWQgI2MxYzFjMTsKICAgIGxpbmUtaGVpZ2h0OiAyNXB4Owp9CgoucmVjZWl2ZVRpbWUgewogICAgZmxvYXQ6IHJpZ2h0Owp9Cg=="},{"version":3,"sources":["FriendChat.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoHA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA","file":"FriendChat.vue","sourceRoot":"src/components","sourcesContent":["<template>\r\n    <div class=\"content\">\r\n        <div class=\"header\">\r\n            <div class=\"backButton\" @click=\"$router.push('/main')\">< Back</div>\r\n            <div class=\"title\">\r\n                <span @click=\"$router.push('/main/friendInfo')\">{{$store.state.queryResult.name}}</span>\r\n            </div>\r\n        </div>\r\n        <div class=\"msgBox\">\r\n            <div class=\"msgRow\" v-for=\"msg in $store.state.queryResult.recMsg\">\r\n                <span class=\"senderName\">{{msg.senderName}}</span>\r\n                <span class=\"receiveTime\">{{msg.time}}</span>\r\n                <br>\r\n                <span class=\"msgContent\">{{msg.msg}}</span>\r\n            </div>\r\n        </div>\r\n        <div class=\"inputBox\">\r\n            <div class=\"toolBar\"></div>\r\n            <textarea class=\"textarea\" v-model=\"chatMsg\" autofocus @keyup.enter=\"sendMsg(chatMsg)\">\r\n            </textarea>\r\n            <div class=\"bottomBar\">\r\n                <div class=\"sendButton\" @click=\"sendMsg(chatMsg)\">发送</div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n    export default {\r\n        name: \"FriendChat\",\r\n        data() {\r\n            return {\r\n                chatMsg: null,\r\n            }\r\n        },\r\n        mounted() {\r\n            // 初始化websocket\r\n            if (typeof (WebSocket) === \"undefined\") {\r\n                alert(\"您的浏览器不支持WebSocket!\")\r\n            } else {\r\n                this.socket = new WebSocket('ws://127.0.0.1:8088/ws')\r\n                this.socket.onopen = this.open\r\n                this.socket.onerror = this.error\r\n                this.socket.onmessage = this.getMessage\r\n            }\r\n        },\r\n        methods: {\r\n            // 定义websocket基础方法\r\n            open() {\r\n                console.log(\"socket连接成功\");\r\n                this.init();\r\n            },\r\n            error() {\r\n                console.log(\"连接错误\")\r\n            },\r\n            send(request) {\r\n                this.socket.send(JSON.stringify(request));\r\n            },\r\n\r\n            getMessage(response) {\r\n                let data = JSON.parse(response.data);\r\n                console.log(data);\r\n                if (data.action === 2) {\r\n                    data.chatMsg.senderName = this.$store.state.queryResult.name;\r\n                    let date = new Date();\r\n                    data.chatMsg.time = date.toLocaleString('chinese', {hour12: false});\r\n                    this.$store.state.queryResult.recMsg.push(data.chatMsg)\r\n                }\r\n            },\r\n            close() {\r\n                console.log(\"socket已经关闭\")\r\n            },\r\n            // 初始化\r\n            init() {\r\n                let initReq = {\r\n                    \"action\": 1,\r\n                    \"chatMsg\": {\r\n                        \"senderId\": this.$store.state.currentUser.id\r\n                    }\r\n                };\r\n                initReq.chatMsg.senderId = this.$store.state.currentUser.id;\r\n                this.send(initReq)\r\n            },\r\n            // 发送消息\r\n            sendMsg(msg) {\r\n                msg = msg.replace('\\n', '');\r\n                if (!msg) {\r\n                    this.chatMsg = null;\r\n                    alert(\"发送内容不能为空，请重新输入\")\r\n                } else {\r\n                    let chatReq = {\r\n                        action: 2,\r\n                        chatMsg: {\r\n                            senderId: null,\r\n                            receiverId: null,\r\n                            msg: null\r\n                        }\r\n                    };\r\n                    chatReq.chatMsg.senderId = this.$store.state.currentUser.id;\r\n                    chatReq.chatMsg.receiverId = this.$store.state.queryResult.id;\r\n                    chatReq.chatMsg.msg = msg.replace('\\n', '');\r\n                    this.send(chatReq);\r\n                    // 把发送的消息写入对话框\r\n                    let date = new Date();\r\n                    chatReq.chatMsg.time = date.toLocaleString('chinese', {hour12: false});\r\n                    chatReq.chatMsg.senderName = this.$store.state.currentUser.name;\r\n                    this.$store.state.queryResult.recMsg.push(chatReq.chatMsg);\r\n                    this.chatMsg = null\r\n                }\r\n            },\r\n        }\r\n    }\r\n\r\n</script>\r\n\r\n<style scoped>\r\n    .content {\r\n        padding: 25px;\r\n    }\r\n\r\n    .header {\r\n        width: 100%;\r\n        height: 60px;\r\n        border-bottom: 1px solid #CCCCCC;\r\n        text-align: right;\r\n    }\r\n\r\n    .title {\r\n        height: 100%;\r\n        padding-right: 20px;\r\n        font-size: 24px;\r\n        font-weight: bolder;\r\n        text-align: center;\r\n        line-height: 70px;\r\n    }\r\n\r\n    .title > span {\r\n        cursor: pointer;\r\n    }\r\n\r\n    .backButton {\r\n        position: absolute;\r\n        cursor: pointer;\r\n        font-size: 20px;\r\n        color: #888888;\r\n    }\r\n\r\n\r\n    .inputBox {\r\n        position: absolute;\r\n        bottom: 0;\r\n        width: 650px;\r\n        height: 300px;\r\n        border-top: 1px solid #CCCCCC;\r\n    }\r\n\r\n    .toolBar {\r\n        width: 100%;\r\n        height: 30px;\r\n    }\r\n\r\n    .textarea {\r\n        width: 644px;\r\n        height: 220px;\r\n        padding: 5px;\r\n        outline: none;\r\n        resize: none;\r\n        border: none;\r\n        background: #EEEEEE;\r\n        font-size: 20px;\r\n        font-family: Arial;\r\n    }\r\n\r\n    .bottomBar {\r\n        text-align: right;\r\n    }\r\n\r\n    .bottomBar > span {\r\n        color: #888888;\r\n        font-size: 10px;\r\n        margin-right: 20px;\r\n\r\n    }\r\n\r\n    .sendButton {\r\n        display: inline-block;\r\n        border: 1px solid #c1c1c1;\r\n        text-decoration: none;\r\n        background-color: #fff;\r\n        color: #222;\r\n        border-radius: 4px;\r\n        padding: 3px 30px;\r\n        font-size: 14px;\r\n        cursor: pointer;\r\n        user-select: none;\r\n    }\r\n\r\n    .sendButton:hover {\r\n        background-color: #d8d8d8;\r\n    }\r\n\r\n    .senderName {\r\n        margin-right: 20px;\r\n    }\r\n\r\n    .msgContent {\r\n        word-wrap: break-word;\r\n        word-break: break-all;\r\n        padding-left: 10px;\r\n    }\r\n\r\n    .msgRow {\r\n        padding: 5px;\r\n        border-bottom: 1px solid #c1c1c1;\r\n        line-height: 25px;\r\n    }\r\n\r\n    .receiveTime {\r\n        float: right;\r\n    }\r\n</style>"]}]}