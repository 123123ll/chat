{"remainingRequest":"E:\\Study\\杉达\\Jee项目实践\\大作业\\project\\chat_frontend_vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\Study\\杉达\\Jee项目实践\\大作业\\project\\chat_frontend_vue\\src\\components\\GroupSetting.vue?vue&type=style&index=0&id=700a12fe&scoped=true&lang=css&","dependencies":[{"path":"E:\\Study\\杉达\\Jee项目实践\\大作业\\project\\chat_frontend_vue\\src\\components\\GroupSetting.vue","mtime":1593580977655},{"path":"E:\\Study\\杉达\\Jee项目实践\\大作业\\project\\chat_frontend_vue\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\Study\\杉达\\Jee项目实践\\大作业\\project\\chat_frontend_vue\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"E:\\Study\\杉达\\Jee项目实践\\大作业\\project\\chat_frontend_vue\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"E:\\Study\\杉达\\Jee项目实践\\大作业\\project\\chat_frontend_vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\Study\\杉达\\Jee项目实践\\大作业\\project\\chat_frontend_vue\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCi5jb250ZW50IHsKICAgIHBhZGRpbmc6IDI1cHg7Cn0KCi5oZWFkZXIgewogICAgd2lkdGg6IDEwMCU7CiAgICBoZWlnaHQ6IDYwcHg7CiAgICBib3JkZXItYm90dG9tOiAxcHggc29saWQgI0NDQ0NDQzsKICAgIHRleHQtYWxpZ246IHJpZ2h0Owp9CgoudGl0bGUgewogICAgaGVpZ2h0OiAxMDAlOwogICAgZm9udC1zaXplOiAyNHB4OwogICAgZm9udC13ZWlnaHQ6IGJvbGRlcjsKICAgIHRleHQtYWxpZ246IGNlbnRlcjsKICAgIGxpbmUtaGVpZ2h0OiA3MHB4Owp9CgouYmFja0J1dHRvbiB7CiAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICBmb250LXNpemU6IDIwcHg7CiAgICBjb2xvcjogIzg4ODg4ODsKfQoKLmluZm9Sb3cgewogICAgdGV4dC1hbGlnbjogY2VudGVyOwogICAgaGVpZ2h0OiA1MHB4OwogICAgbWFyZ2luOiAwIDIwMHB4OwogICAgZm9udC1zaXplOiAxNnB4OwogICAgbGluZS1oZWlnaHQ6IDcwcHg7CiAgICBib3JkZXItYm90dG9tOiAxcHggc29saWQgI0NDQ0NDQzsKfQoKLmdyb3VwSW5mbyB0ZXh0YXJlYSB7CiAgICB3aWR0aDogMjMwcHg7CiAgICBoZWlnaHQ6IDg1cHg7CiAgICBtYXJnaW4tYm90dG9tOiAxMHB4OwogICAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkICNDQ0NDQ0M7Cn0KCi5zYXZlIHsKICAgIGZvbnQtd2VpZ2h0OiBib2xkOwogICAgY3Vyc29yOiBwb2ludGVyOwp9CgoubWVtYmVyQm94IHsKICAgIHdpZHRoOiA2MDRweDsKICAgIG1hcmdpbjogMCBhdXRvOwogICAgZGlzcGxheTogZmxleDsKICAgIGZsZXgtd3JhcDogd3JhcDsKfQoKLm1lbWJlciB7CiAgICB3aWR0aDogMzAwcHg7CiAgICBoZWlnaHQ6IDUwcHg7CiAgICBsaW5lLWhlaWdodDogNDBweDsKICAgIGJvcmRlcjogMXB4IHNvbGlkICNDQ0NDQ0M7CiAgICBib3gtc2l6aW5nOiBib3JkZXItYm94OwogICAgcGFkZGluZzogNXB4OwogICAgbWFyZ2luOiAxcHg7Cn0KCi5hY3Rpb25Cb3ggewogICAgZmxvYXQ6IHJpZ2h0Owp9Cgouc2V0QWRtaW4gewogICAgY29sb3I6IGdyZWVuOwogICAgY3Vyc29yOiBwb2ludGVyOwp9CgoucmVtb3ZlQWRtaW4gewogICAgY29sb3I6IGdyYXk7CiAgICBjdXJzb3I6IHBvaW50ZXI7Cn0KCi5yZW1vdmVNZW1iZXIgewogICAgbWFyZ2luLWxlZnQ6IDEwcHg7CiAgICBjb2xvcjogcmVkOwogICAgY3Vyc29yOiBwb2ludGVyOwp9CgouZGlzYmFuZCB7CiAgICBjb2xvcjogcmVkOwogICAgZm9udC13ZWlnaHQ6IGJvbGQ7CiAgICBjdXJzb3I6IHBvaW50ZXI7Cn0KCi5hY2NlcHQgewogICAgY29sb3I6IGdyZWVuOwogICAgY3Vyc29yOiBwb2ludGVyOwogICAgbWFyZ2luLXJpZ2h0OiAxMHB4Owp9CgouaWdub3JlIHsKICAgIGNvbG9yOiByZWQ7CiAgICBjdXJzb3I6IHBvaW50ZXI7Cn0K"},{"version":3,"sources":["GroupSetting.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoMA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA","file":"GroupSetting.vue","sourceRoot":"src/components","sourcesContent":["<template>\r\n    <div class=\"content\">\r\n        <div class=\"header\">\r\n            <div class=\"backButton\" @click=\"$router.push('/main/groupchat')\">< Back</div>\r\n            <div class=\"title\">\r\n                <span>群设置</span>\r\n            </div>\r\n        </div>\r\n        <div class=\"groupInfo\">\r\n            <div class=\"infoRow\">群主：{{masterName}}</div>\r\n            <div class=\"infoRow\">群名：<input type=\"text\" size=\"15\" :placeholder=\"this.groupSetting.name\"\r\n                                           v-model=\"groupSetting.name\" :disabled=\"currentRoleId===0\"></div>\r\n            <div class=\"infoRow\" style=\"border: none\">群介绍</div>\r\n            <div class=\"infoRow\" style=\"margin-top: 5px;height: 100px\">\r\n                <textarea :placeholder=\"groupSetting.info\" v-model=\"groupSetting.info\"\r\n                          :disabled=\"currentRoleId===0\"></textarea>\r\n            </div>\r\n            <div class=\"infoRow save\" @click=\"saveInfo\" v-text=\"saveButton\"></div>\r\n            <div class=\"infoRow disband\" @click=\"disbandGroup\" v-text=\"disbandButton\"></div>\r\n        </div>\r\n        <div class=\"groupMember\">\r\n            <div class=\"infoRow\" style=\"margin: 50px 0\"><h2>群成员</h2></div>\r\n            <div class=\"memberBox\">\r\n                <div class=\"member\" v-for=\"member in memberList\" v-if='memberList[0]'\r\n                     @mouseenter=\"showAction(member.id)\" @mouseleave=\"show = null\">\r\n                    <span class=\"chara\">[{{member.groupId === 2 ? '群主' : member.groupId === 1 ? '管理员' : '群员' }}] </span>\r\n                    <span class=\"name\">{{member.name}}</span>\r\n                    <div class=\"actionBox\" v-show=\"member.id === show\">\r\n                        <span class=\"setAdmin\" v-show=\"currentRoleId === 2 && member.groupId === 0\"\r\n                              @click=\"setAdmin(member.id)\">设为管理员</span>\r\n                        <span class=\"removeAdmin\" v-show=\"currentRoleId === 2 && member.groupId === 1\"\r\n                              @click=\"removeAdmin(member.id)\">取消管理员</span>\r\n                        <span class=\"removeMember\" v-show=\"currentRoleId > member.groupId\"\r\n                              @click=\"removeMember(member.id)\">移出群聊</span>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div class=\"joinRequest\" v-if=\"currentRoleId > 0\">\r\n                <div class=\"infoRow\" style=\"margin: 50px 0\"><h2>加群请求</h2></div>\r\n                <div class=\"member\" v-for=\"request in joinRequest\" @mouseenter=\"showAction(request.id)\"\r\n                     @mouseleave=\"show = null\">\r\n                    <span>{{request.userVo.name}}</span>\r\n                    <div class=\"actionBox\" v-show=\"request.id === show\">\r\n                        <span class=\"accept\" @click=\"joinAccept(request.sendUserId)\">允许加群</span>\r\n                        <span class=\"ignore\" @click=\"joinIgnore(request.sendUserId)\">忽略</span>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n    import router from \"../router\";\r\n\r\n    export default {\r\n        name: \"GroupSetting\",\r\n        data() {\r\n            return {\r\n                show: null,\r\n                currentRoleId: null,\r\n                saveButton: '保存',\r\n                disbandButton: '解散该群',\r\n                masterName: null,\r\n                groupSetting: this.$store.state.queryResult,\r\n                memberList: {\r\n                    \"id\": null,\r\n                    \"name\": null,\r\n                    \"nickname\": null,\r\n                    \"gender\": null,\r\n                    \"groupId\": 0,\r\n                },\r\n                joinRequest: null\r\n            }\r\n        },\r\n        mounted() {\r\n            // 检查群权限\r\n            this.axios.get(\"/group/queryUserRole/\" + this.groupSetting.id).then(response => {\r\n                this.currentRoleId = response.data;\r\n            }).catch(function (error) {\r\n                console.log(error.response.data);\r\n            });\r\n            // 搜索群主用户名\r\n            this.axios.get(\"/user/queryUser/\" + this.groupSetting.masterId).then(response => {\r\n                this.masterName = response.data.name;\r\n            }).catch(function (error) {\r\n                console.log(error.response.data);\r\n            });\r\n            // 拉取群成员\r\n            this.axios.get(\"/group/members/\" + this.groupSetting.id).then(response => {\r\n                this.memberList = response.data;\r\n            }).catch(function (error) {\r\n                console.log(error.response.data);\r\n            });\r\n            // 拉取加群请求\r\n            this.axios.get(\"/group/searchGroupRequest/\" + this.groupSetting.id).then(response => {\r\n                console.log(response.data)\r\n                this.joinRequest = response.data;\r\n            }).catch(function (error) {\r\n                console.log(error.response.error);\r\n            });\r\n        },\r\n        methods: {\r\n            showAction(member) {\r\n                this.show = member;\r\n            },\r\n            saveInfo() {\r\n                delete this.groupSetting.flag;\r\n                delete this.groupSetting.createTime;\r\n                delete this.groupSetting.recMsg;\r\n                this.axios.post('/group/changeGroupInfo', this.groupSetting).then(() => {\r\n                    this.saveButton = \"保存成功！\";\r\n                    setTimeout(() => {\r\n                        this.axios.get(\"/user/group\").then(response => {\r\n                            this.$store.commit('setGroupList', response.data);\r\n                        })\r\n                        router.replace(\"/main/groupchat\");\r\n                    }, 1000)\r\n                }).catch(error => {\r\n                    alert(error.response.data.message);\r\n                });\r\n            },\r\n            setAdmin(userId) {\r\n                this.axios.post('/group/setUserManageRole/' + this.groupSetting.id + '/' + userId).then(() => {\r\n                    this.$router.go(0);\r\n                }).catch(error => {\r\n                    console.log(error.response.data)\r\n                });\r\n            },\r\n            removeAdmin(userId) {\r\n                this.axios.post('/group/removeUserManageRole/' + this.groupSetting.id + '/' + userId).then(() => {\r\n                    this.$router.go(0);\r\n                }).catch(error => {\r\n                    console.log(error.response.data)\r\n                });\r\n            },\r\n            removeMember(userId) {\r\n                this.axios.post('/group//removeGroupUser/' + this.groupSetting.id + '/' + userId).then(() => {\r\n                    this.$router.go(0);\r\n                }).catch(error => {\r\n                    console.log(error.response.data)\r\n                });\r\n            },\r\n            disbandGroup() {\r\n                this.axios.post('/group/dissolute/' + this.groupSetting.id).then(() => {\r\n                    this.disbandButton = '解散成功';\r\n                    // 获取群组\r\n                    this.axios.get(\"/user/group\").then(response => {\r\n                        this.$store.commit('setGroupList', response.data);\r\n                    }).catch((error) => {\r\n                        if (error.response.status === 401) {\r\n                            router.replace(\"/welcome\")\r\n                        }\r\n                    })\r\n                    setTimeout(function () {\r\n                        router.push('/main');\r\n                    }, 1000)\r\n                }).catch(error => {\r\n                    console.log(error.response.data)\r\n                });\r\n\r\n            },\r\n            joinAccept(userId) {\r\n                let req = {\r\n                    sendGroupId: null,\r\n                    sendUserId: null,\r\n                    operationType: 1,\r\n                };\r\n                req.sendGroupId = this.groupSetting.id;\r\n                req.sendUserId = userId;\r\n                this.axios.post('/group/acceptGroup', req).then(() => {\r\n                    this.$router.go(0);\r\n                }).catch(error => {\r\n                    console.log(error.response.data)\r\n                });\r\n            },\r\n            joinIgnore(userId) {\r\n                let req = {\r\n                    sendGroupId: null,\r\n                    sendUserId: null,\r\n                    operationType: 0,\r\n                };\r\n                req.sendGroupId = this.groupSetting.id;\r\n                req.sendUserId = userId;\r\n                this.axios.post('/group/acceptGroup', req).then(() => {\r\n                    this.$router.go(0);\r\n                }).catch(error => {\r\n                    console.log(error.response.data)\r\n                });\r\n            },\r\n        },\r\n    }\r\n\r\n</script>\r\n\r\n<style scoped>\r\n    .content {\r\n        padding: 25px;\r\n    }\r\n\r\n    .header {\r\n        width: 100%;\r\n        height: 60px;\r\n        border-bottom: 1px solid #CCCCCC;\r\n        text-align: right;\r\n    }\r\n\r\n    .title {\r\n        height: 100%;\r\n        font-size: 24px;\r\n        font-weight: bolder;\r\n        text-align: center;\r\n        line-height: 70px;\r\n    }\r\n\r\n    .backButton {\r\n        position: absolute;\r\n        cursor: pointer;\r\n        font-size: 20px;\r\n        color: #888888;\r\n    }\r\n\r\n    .infoRow {\r\n        text-align: center;\r\n        height: 50px;\r\n        margin: 0 200px;\r\n        font-size: 16px;\r\n        line-height: 70px;\r\n        border-bottom: 1px solid #CCCCCC;\r\n    }\r\n\r\n    .groupInfo textarea {\r\n        width: 230px;\r\n        height: 85px;\r\n        margin-bottom: 10px;\r\n        border-bottom: 1px solid #CCCCCC;\r\n    }\r\n\r\n    .save {\r\n        font-weight: bold;\r\n        cursor: pointer;\r\n    }\r\n\r\n    .memberBox {\r\n        width: 604px;\r\n        margin: 0 auto;\r\n        display: flex;\r\n        flex-wrap: wrap;\r\n    }\r\n\r\n    .member {\r\n        width: 300px;\r\n        height: 50px;\r\n        line-height: 40px;\r\n        border: 1px solid #CCCCCC;\r\n        box-sizing: border-box;\r\n        padding: 5px;\r\n        margin: 1px;\r\n    }\r\n\r\n    .actionBox {\r\n        float: right;\r\n    }\r\n\r\n    .setAdmin {\r\n        color: green;\r\n        cursor: pointer;\r\n    }\r\n\r\n    .removeAdmin {\r\n        color: gray;\r\n        cursor: pointer;\r\n    }\r\n\r\n    .removeMember {\r\n        margin-left: 10px;\r\n        color: red;\r\n        cursor: pointer;\r\n    }\r\n\r\n    .disband {\r\n        color: red;\r\n        font-weight: bold;\r\n        cursor: pointer;\r\n    }\r\n\r\n    .accept {\r\n        color: green;\r\n        cursor: pointer;\r\n        margin-right: 10px;\r\n    }\r\n\r\n    .ignore {\r\n        color: red;\r\n        cursor: pointer;\r\n    }\r\n</style>"]}]}