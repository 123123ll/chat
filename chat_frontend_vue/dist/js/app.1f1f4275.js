(function(t){function e(e){for(var n,r,i=e[0],c=e[1],u=e[2],d=0,p=[];d<i.length;d++)r=i[d],Object.prototype.hasOwnProperty.call(a,r)&&a[r]&&p.push(a[r][0]),a[r]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(t[n]=c[n]);l&&l(e);while(p.length)p.shift()();return o.push.apply(o,u||[]),s()}function s(){for(var t,e=0;e<o.length;e++){for(var s=o[e],n=!0,i=1;i<s.length;i++){var c=s[i];0!==a[c]&&(n=!1)}n&&(o.splice(e--,1),t=r(r.s=s[0]))}return t}var n={},a={app:0},o=[];function r(e){if(n[e])return n[e].exports;var s=n[e]={i:e,l:!1,exports:{}};return t[e].call(s.exports,s,s.exports,r),s.l=!0,s.exports}r.m=t,r.c=n,r.d=function(t,e,s){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(r.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)r.d(s,n,function(e){return t[e]}.bind(null,n));return s},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],c=i.push.bind(i);i.push=e,i=i.slice();for(var u=0;u<i.length;u++)e(i[u]);var l=c;o.push([0,"chunk-vendors"]),s()})({0:function(t,e,s){t.exports=s("56d7")},"034f":function(t,e,s){"use strict";var n=s("85ec"),a=s.n(n);a.a},"0e90":function(t,e,s){},"0eb8":function(t,e,s){},"10b7":function(t,e,s){"use strict";var n=s("ca08"),a=s.n(n);a.a},"126f":function(t,e,s){},"13ea":function(t,e,s){"use strict";var n=s("7f8b"),a=s.n(n);a.a},"158e":function(t,e,s){},"171a":function(t,e,s){"use strict";var n=s("2e75"),a=s.n(n);a.a},2111:function(t,e,s){},"2a4b":function(t,e,s){},"2e75":function(t,e,s){},"55c6":function(t,e,s){},"56d7":function(t,e,s){"use strict";s.r(e);s("e260"),s("e6cf"),s("cca6"),s("a79d");var n=s("2b0e"),a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"app"}},[s("router-link",{attrs:{to:"/"}}),s("router-view")],1)},o=[],r=(s("034f"),s("2877")),i={},c=Object(r["a"])(i,a,o,!1,null,null,null),u=c.exports,l=s("bc3a"),d=s.n(l),p=s("8c4f"),m=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"app"}},[s("form",{attrs:{action:"",id:"loginForm"}},[s("h1",{domProps:{textContent:t._s(t.title)}}),s("label",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.params.text,expression:"params.text"}],staticClass:"input",attrs:{type:"text",placeholder:"Email or Telephone",checked:""},domProps:{value:t.params.text},on:{input:function(e){e.target.composing||t.$set(t.params,"text",e.target.value)}}})]),s("br"),s("label",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.params.password,expression:"params.password"}],staticClass:"input",attrs:{type:"password",placeholder:"Password"},domProps:{value:t.params.password},on:{keypress:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.auth(e)},input:function(e){e.target.composing||t.$set(t.params,"password",e.target.value)}}})]),s("br"),s("br"),s("span",{attrs:{id:"errMsg"},domProps:{textContent:t._s(t.errMsg)}})]),s("h1",[t._v("or")]),s("transition",{attrs:{name:"scale"}},[s("router-link",{attrs:{to:"/register",id:"register"}},[t._v("Register→")])],1)],1)},f=[],v=(s("b0c0"),s("ac1f"),s("5319"),{router:Lt,data:function(){return{title:"Login",params:{text:"",password:""},errMsg:""}},mounted:function(){},methods:{auth:function(){var t=this;this.axios.post("/auth/login",this.params).then((function(e){t.title="Hello! "+e.data.name,t.$store.commit("setCurrentUser",e.data),setTimeout((function(){Lt.replace("/main")}),1e3)})).catch((function(e){t.errMsg=e.response.data.message}))}}}),h=v,g=(s("dff8"),Object(r["a"])(h,m,f,!1,null,"370e5710",null)),_=g.exports,C=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"content"},[s("form",{attrs:{action:"",id:"registerForm"}},[s("h1",[t._v("Register")]),s("label",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.params.name,expression:"params.name"}],staticClass:"input",attrs:{type:"text",placeholder:"Nickname"},domProps:{value:t.params.name},on:{input:function(e){e.target.composing||t.$set(t.params,"name",e.target.value)}}})]),s("label",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.params.password,expression:"params.password"}],staticClass:"input",attrs:{type:"password",placeholder:"Password"},domProps:{value:t.params.password},on:{input:function(e){e.target.composing||t.$set(t.params,"password",e.target.value)}}})]),s("div",{staticClass:"genderBox"},[s("label",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.params.gender,expression:"params.gender"}],attrs:{type:"radio",name:"gender",value:"1"},domProps:{checked:t._q(t.params.gender,"1")},on:{change:function(e){return t.$set(t.params,"gender","1")}}})]),s("span",{staticClass:"gender"},[t._v("Male")]),s("span",{staticStyle:{display:"inline-block",width:"20px"}}),s("label",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.params.gender,expression:"params.gender"}],attrs:{type:"radio",name:"gender",value:"2"},domProps:{checked:t._q(t.params.gender,"2")},on:{change:function(e){return t.$set(t.params,"gender","2")}}})]),s("span",{staticClass:"gender"},[t._v("Female")])]),s("label",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.params.email,expression:"params.email"}],staticClass:"input",attrs:{type:"text",placeholder:"Email"},domProps:{value:t.params.email},on:{input:function(e){e.target.composing||t.$set(t.params,"email",e.target.value)}}})]),s("label",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.params.telephone,expression:"params.telephone"}],staticClass:"input",attrs:{type:"text",placeholder:"Telephone"},domProps:{value:t.params.telephone},on:{keypress:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.register(e)},input:function(e){e.target.composing||t.$set(t.params,"telephone",e.target.value)}}})]),s("br"),s("br"),s("router-link",{attrs:{to:"/",id:"back"}},[t._v("← Back to login")]),s("span",{staticStyle:{display:"inline-block",width:"100px"}}),s("a",{staticStyle:{cursor:"pointer"},attrs:{id:"submit"},on:{click:t.register}},[t._v("Submit →")])],1)])},b=[],w={data:function(){return{params:{name:"",password:"",gender:"",email:"",telephone:""}}},methods:{register:function(){this.axios.post("/auth/register",this.params).then((function(t){console.log(t.data),alert("注册成功"),Lt.push("/")})).catch((function(t){alert(t.response.data.message)}))}}},x=w,k=(s("13ea"),Object(r["a"])(x,C,b,!1,null,"648b8c48",null)),y=k.exports,$=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"main"},[s("div",{staticClass:"left"},[s("div",{staticClass:"leftHeader"},[s("div",{staticClass:"avatar"},[s("span",{domProps:{textContent:t._s(t.$store.state.currentUser.name.substr(0,1))}})]),s("p",{staticClass:"userName",domProps:{textContent:t._s(t.$store.state.currentUser.name)},on:{click:function(e){return t.$router.push("/main/editinfo")}}})]),s("div",{staticClass:"search"},[s("label",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.search,expression:"search"}],attrs:{type:"text",placeholder:"用户名称/群名称"},domProps:{value:t.search},on:{input:function(e){e.target.composing||(t.search=e.target.value)}}})]),s("div",{staticClass:"searchUser",on:{click:t.searchUser}},[t._v("搜人")]),s("div",{staticClass:"searchGroup",on:{click:t.searchGroup}},[t._v("搜群")])]),s("div",{staticClass:"tabBox"},t._l(t.tabList,(function(e){return s("div",{staticClass:"tab",class:{active:t.$store.state.currentTab===e},domProps:{textContent:t._s(e)},on:{click:function(s){return t.selected(e)}}})})),0),s("div",{staticClass:"listBox"},[s("div",{directives:[{name:"show",rawName:"v-show",value:"消息"===t.$store.state.currentTab,expression:"$store.state.currentTab==='消息'"}],staticClass:"list"},[t._v("消息")]),s("div",{directives:[{name:"show",rawName:"v-show",value:"好友"===t.$store.state.currentTab,expression:"$store.state.currentTab==='好友'"}],staticClass:"list"},[s("div",{staticClass:"friendRequest",on:{click:function(e){return t.$router.push("/main/friendRequest")}}},[t._v("好友请求")]),t._l(t.$store.state.friendList,(function(e){return s("div",{staticClass:"friendGroupList"},[s("span",{staticClass:"friendGroupName"},[t._v(t._s(e.groupName))]),t._l(e.users,(function(e){return s("div",{staticClass:"friendsList",on:{click:function(s){return t.queryFriend(e.id)}}},[s("div",{staticClass:"friendsAvatar"},[s("span",{domProps:{textContent:t._s(e.name.substr(0,1))}})]),s("div",{staticClass:"friendsName",domProps:{textContent:t._s(e.name)}})])}))],2)}))],2),s("div",{directives:[{name:"show",rawName:"v-show",value:"群组"===t.$store.state.currentTab,expression:"$store.state.currentTab==='群组'"}],staticClass:"list"},[s("div",{staticClass:"groupList createGroup",on:{click:function(e){return t.$router.push("/main/createGroup")}}},[t._v("+ 创建群聊")]),t._l(t.$store.state.groupList,(function(e){return s("div",{staticClass:"groupList",on:{click:function(s){return t.queryGroup(e.id)}}},[s("span",{staticClass:"groupName"},[t._v(t._s(e.name))])])}))],2)]),s("div",{staticClass:"logout",on:{click:t.logout}},[t._v("注销")])]),s("div",{staticClass:"right"},[s("router-view")],1)])},R=[],M=(s("841c"),{router:Lt,data:function(){return{isLogin:!1,search:null,tabList:["消息","好友","群组"],friend:null}},mounted:function(){var t=this;this.axios.get("/user/friend").then((function(e){t.$store.commit("setFriendList",e.data)})).catch((function(t){401===t.response.status&&Lt.replace("/welcome")})),this.axios.get("/user/group").then((function(e){t.$store.commit("setGroupList",e.data)})).catch((function(t){401===t.response.status&&Lt.replace("/welcome")}))},destroyed:function(){this.socket.onclose=this.close},methods:{selected:function(t){this.$store.commit("setCurrentTab",t)},logout:function(){this.axios.post("/auth/logout").then((function(){Lt.replace("/welcome")})).catch((function(t){console.log(t.response.data)}))},queryFriend:function(t){var e=this;this.axios.get("/friend/info/"+t).then((function(t){t.data.recMsg=[],e.$store.commit("setQueryResult",t.data),e.$router.push("/main/friendchat")})).catch((function(t){console.log(t.response.data)}))},queryGroup:function(t){var e=this;this.axios.get("/group/infoGroup/"+t).then((function(t){t.data.recMsg=[],e.$store.commit("setQueryResult",t.data),e.$router.push("/main/groupchat")})).catch((function(t){console.log(t.response.data)}))},searchUser:function(){var t=this;this.axios.get("/user/queryUser?name="+this.search).then((function(e){0!==e.data.length?(t.$store.commit("setSearchResult",e.data),Lt.push("/main/searchuser")):alert("无搜索结果")})).catch((function(t){console.log(t.response.data)}))},searchGroup:function(){var t=this;this.axios.get("/group/queryGroup/"+this.search).then((function(e){0!==e.data.length?(t.$store.commit("setSearchResult",e.data),Lt.push("/main/searchgroup")):alert("无搜索结果")})).catch((function(t){console.log(t.response.data)}))}}}),I=M,N=(s("5d43"),Object(r["a"])(I,$,R,!1,null,"8eb2ad4c",null)),S=N.exports,B=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"editInfo"},[s("div",{staticClass:"header"},[s("div",{staticClass:"backButton",on:{click:function(e){return t.$router.push("/main")}}},[t._v("< Back")]),s("div",{staticClass:"title"},[t._v("修改用户信息")])]),s("div",{staticClass:"infoRow"},[t._v("名称："),s("input",{directives:[{name:"model",rawName:"v-model",value:t.info.name,expression:"info.name"}],attrs:{type:"text"},domProps:{value:t.info.name},on:{input:function(e){e.target.composing||t.$set(t.info,"name",e.target.value)}}})]),s("div",{staticClass:"infoRow"},[t._v("性别： "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.info.gender,expression:"info.gender"}],attrs:{type:"radio",name:"gender",value:"1"},domProps:{checked:t._q(t.info.gender,"1")},on:{change:function(e){return t.$set(t.info,"gender","1")}}}),s("span",{staticClass:"gender"},[t._v("男")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.info.gender,expression:"info.gender"}],attrs:{type:"radio",name:"gender",value:"2"},domProps:{checked:t._q(t.info.gender,"2")},on:{change:function(e){return t.$set(t.info,"gender","2")}}}),s("span",{staticClass:"gender"},[t._v("女")])]),s("div",{staticClass:"infoRow"},[t._v("生日："),s("input",{directives:[{name:"model",rawName:"v-model",value:t.info.birthday,expression:"info.birthday"}],attrs:{type:"text"},domProps:{value:t.info.birthday},on:{input:function(e){e.target.composing||t.$set(t.info,"birthday",e.target.value)}}})]),s("div",{staticClass:"infoRow"},[t._v("邮箱："),s("input",{directives:[{name:"model",rawName:"v-model",value:t.info.email,expression:"info.email"}],attrs:{type:"text"},domProps:{value:t.info.email},on:{input:function(e){e.target.composing||t.$set(t.info,"email",e.target.value)}}})]),s("div",{staticClass:"infoRow"},[t._v("电话："),s("input",{directives:[{name:"model",rawName:"v-model",value:t.info.telephone,expression:"info.telephone"}],attrs:{type:"text"},domProps:{value:t.info.telephone},on:{input:function(e){e.target.composing||t.$set(t.info,"telephone",e.target.value)}}})]),s("div",{staticClass:"infoRow save",domProps:{textContent:t._s(t.saveButton)},on:{click:t.saveInfo}})])},P=[],q={name:"EditInfo",data:function(){return{info:null,saveButton:"保存",errMsg:null}},created:function(){this.info=this.$store.state.currentUser},methods:{saveInfo:function(){var t=this;this.axios.post("/user/info",this.info).then((function(e){t.$store.commit("setCurrentUser",e.data),t.saveButton="保存成功！",setTimeout((function(){Lt.push("/main")}),1e3)})).catch((function(t){alert(t.response.data.message)}))}}},L=q,O=(s("65bd"),Object(r["a"])(L,B,P,!1,null,"30eb86ec",null)),j=O.exports,T=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"content"},[s("div",{staticClass:"header"},[s("div",{staticClass:"backButton",on:{click:function(e){return t.$router.push("/main")}}},[t._v("< Back")]),s("div",{staticClass:"title"},[t._v("搜索用户")])]),t._l(t.$store.state.searchResult,(function(e){return s("div",{staticClass:"result"},[s("div",{staticClass:"resultRow"},[s("div",{staticClass:"userName"},[t._v(t._s(e.name))]),s("div",{staticClass:"isFriend"},[s("span",{directives:[{name:"show",rawName:"v-show",value:e.isFriend,expression:"item.isFriend"}]},[t._v("好友")]),s("div",{directives:[{name:"show",rawName:"v-show",value:!e.isFriend,expression:"!item.isFriend"}],staticClass:"addButton",on:{click:function(s){return t.addFriend(e.id)}}},[t._v("加为好友")])])])])}))],2)},U=[],E={name:"searchResult",methods:{addFriend:function(t){this.axios.post("/friend/request/"+t).then((function(t){alert("好友申请发送成功！")})).catch((function(t){alert(t.response.data)}))}}},G=E,F=(s("906c"),Object(r["a"])(G,T,U,!1,null,"78c0db3d",null)),A=F.exports,J=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"content"},[s("div",{staticClass:"header"},[s("div",{staticClass:"backButton",on:{click:function(e){return t.$router.push("/main")}}},[t._v("< Back")]),s("div",{staticClass:"title"},[t._v("搜索群组")])]),t._l(t.$store.state.searchResult,(function(e){return s("div",{staticClass:"result"},[s("div",{staticClass:"resultRow"},[s("div",{staticClass:"groupName"},[t._v(t._s(e.name))]),s("div",{staticClass:"groupJoined"},[s("span",{directives:[{name:"show",rawName:"v-show",value:e.joined,expression:"item.joined"}]},[t._v("已加入")]),s("div",{directives:[{name:"show",rawName:"v-show",value:!e.joined,expression:"!item.joined"}],staticClass:"joinButton"},[t._v("申请入群")])])])])}))],2)},W=[],D={name:"searchResult"},Q=D,H=(s("171a"),Object(r["a"])(Q,J,W,!1,null,"b6e95ee4",null)),z=H.exports,K=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"content"},[s("div",{staticClass:"header"},[s("div",{staticClass:"backButton",on:{click:function(e){return t.$router.push("/main")}}},[t._v("< Back")]),t._m(0)]),t._l(t.requestList,(function(e){return s("div",{staticClass:"infoRow"},[s("span",[t._v(t._s(e.name))]),s("span",{staticClass:"ignore",on:{click:function(s){return t.ignore(e.id)}}},[t._v("忽略")]),s("span",{staticClass:"accept",on:{click:function(s){return t.accept(e.id)}}},[t._v("同意")])])}))],2)},V=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"title"},[s("span",[t._v("好友请求")])])}],X={name:"FriendRequest",data:function(){return{requestList:null}},mounted:function(){var t=this;this.axios.get("/friend/friendRequest").then((function(e){t.requestList=e.data})).catch((function(t){alert(t.response.data)}))},methods:{accept:function(t){var e={sendUserId:t,operationType:1};this.axios.post("/friend/accept",e).then((function(t){console.log(t),alert("好友添加成功")})).catch((function(t){alert(t.response.data.message)}))},ignore:function(t){var e={sendUserId:t,operationType:0};this.axios.post("/friend/accept",e).then((function(t){console.log(t),alert("已忽略该好友请求")})).catch((function(t){alert(t.response.data.message)}))}}},Y=X,Z=(s("6976"),Object(r["a"])(Y,K,V,!1,null,"63bbec90",null)),tt=Z.exports,et=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"content"},[s("div",{staticClass:"header"},[s("div",{staticClass:"backButton",on:{click:function(e){return t.$router.push("/main")}}},[t._v("< Back")]),s("div",{staticClass:"title"},[s("span",{on:{click:function(e){return t.$router.push("/main/friendInfo")}}},[t._v(t._s(t.$store.state.queryResult.name))])])]),s("div",{staticClass:"msgBox"},t._l(t.$store.state.queryResult.recMsg,(function(e){return s("div",{staticClass:"msgRow"},[s("span",{staticClass:"senderName"},[t._v(t._s(e.senderName))]),s("span",{staticClass:"receiveTime"},[t._v(t._s(e.time))]),s("br"),s("span",{staticClass:"msgContent"},[t._v(t._s(e.msg))])])})),0),s("div",{staticClass:"inputBox"},[s("div",{staticClass:"toolBar"}),s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.chatMsg,expression:"chatMsg"}],staticClass:"textarea",attrs:{autofocus:""},domProps:{value:t.chatMsg},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.sendMsg(t.chatMsg)},input:function(e){e.target.composing||(t.chatMsg=e.target.value)}}}),s("div",{staticClass:"bottomBar"},[s("div",{staticClass:"sendButton",on:{click:function(e){return t.sendMsg(t.chatMsg)}}},[t._v("发送")])])])])},st=[],nt={name:"FriendChat",data:function(){return{chatMsg:null}},mounted:function(){"undefined"===typeof WebSocket?alert("您的浏览器不支持WebSocket!"):(this.socket=new WebSocket("ws://127.0.0.1:8088/ws"),this.socket.onopen=this.open,this.socket.onerror=this.error,this.socket.onmessage=this.getMessage)},methods:{open:function(){console.log("socket连接成功"),this.init()},error:function(){console.log("连接错误")},send:function(t){this.socket.send(JSON.stringify(t))},getMessage:function(t){var e=JSON.parse(t.data);if(console.log(e),2===e.action){e.chatMsg.senderName=this.$store.state.queryResult.name;var s=new Date;e.chatMsg.time=s.toLocaleString("chinese",{hour12:!1}),this.$store.state.queryResult.recMsg.push(e.chatMsg)}},close:function(){console.log("socket已经关闭")},init:function(){var t={action:1,chatMsg:{senderId:this.$store.state.currentUser.id}};t.chatMsg.senderId=this.$store.state.currentUser.id,this.send(t)},sendMsg:function(t){if(t=t.replace("\n",""),t){var e={action:2,chatMsg:{senderId:null,receiverId:null,msg:null}};e.chatMsg.senderId=this.$store.state.currentUser.id,e.chatMsg.receiverId=this.$store.state.queryResult.id,e.chatMsg.msg=t.replace("\n",""),this.send(e);var s=new Date;e.chatMsg.time=s.toLocaleString("chinese",{hour12:!1}),e.chatMsg.senderName=this.$store.state.currentUser.name,this.$store.state.queryResult.recMsg.push(e.chatMsg),this.chatMsg=null}else this.chatMsg=null,alert("发送内容不能为空，请重新输入")}}},at=nt,ot=(s("dd28"),Object(r["a"])(at,et,st,!1,null,"be9c8f32",null)),rt=ot.exports,it=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"friendInfo"},[s("div",{staticClass:"header"},[s("div",{staticClass:"backButton",on:{click:function(e){return t.$router.back()}}},[t._v("< Back")]),s("div",{staticClass:"title"},[t._v("好友信息")])]),s("div",{staticClass:"infoRow"},[t._v("用户名："+t._s(t.$store.state.queryResult.name))]),s("div",{staticClass:"infoRow"},[t._v("备注："+t._s(t.$store.state.queryResult.nickname))]),s("div",{staticClass:"infoRow"},[t._v("性别："+t._s(1===t.$store.state.queryResult.gender?"男":"女"))]),s("div",{staticClass:"infoRow deleteFriend",on:{click:function(e){return t.deleteFriend(t.$store.state.queryResult.id)}}},[t._v("删除好友")])])},ct=[],ut={name:"FriendInfo",methods:{deleteFriend:function(t){this.axios.post("/friend/delete/"+t).then((function(t){console.log(t.data),alert("删除成功"),Lt.replace("/main")})).catch((function(t){alert(t.response.data.message)}))}}},lt=ut,dt=(s("782e"),Object(r["a"])(lt,it,ct,!1,null,"cdeb2f32",null)),pt=dt.exports,mt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"content"},[s("div",{staticClass:"header"},[s("div",{staticClass:"backButton",on:{click:function(e){return t.$router.push("/main")}}},[t._v("< Back")]),s("div",{staticClass:"title"},[s("span",{on:{click:function(e){return t.$router.push("/main/groupsetting")}}},[t._v(t._s(t.$store.state.queryResult.name))])])]),s("div",{staticClass:"msgBox"},t._l(t.$store.state.queryResult.recMsg,(function(e){return s("div",{staticClass:"msgRow"},[s("span",{staticClass:"senderName"},[t._v(t._s(e.senderName))]),s("span",{staticClass:"receiveTime"},[t._v(t._s(e.time))]),s("br"),s("span",{staticClass:"msgContent"},[t._v(t._s(e.msg))])])})),0),s("div",{staticClass:"inputBox"},[s("div",{staticClass:"toolBar"}),s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.chatMsg,expression:"chatMsg"}],staticClass:"textarea",attrs:{autofocus:""},domProps:{value:t.chatMsg},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.sendMsg(t.chatMsg)},input:function(e){e.target.composing||(t.chatMsg=e.target.value)}}}),s("div",{staticClass:"bottomBar"},[s("div",{staticClass:"sendButton",on:{click:function(e){return t.sendMsg(t.chatMsg)}}},[t._v("发送")])])])])},ft=[],vt={name:"GroupChat",data:function(){return{chatMsg:null}},mounted:function(){"undefined"===typeof WebSocket?alert("您的浏览器不支持WebSocket!"):(this.socket=new WebSocket("ws://127.0.0.1:8088/ws"),this.socket.onopen=this.open,this.socket.onerror=this.error,this.socket.onmessage=this.getMessage)},methods:{open:function(){console.log("socket连接成功"),this.init()},error:function(){console.log("连接错误")},send:function(t){this.socket.send(JSON.stringify(t))},getMessage:function(t){var e=JSON.parse(t.data);if(console.log(e),10===e.action){var s=new Date;e.chatMsg.time=s.toLocaleString("chinese",{hour12:!1}),this.$store.state.queryResult.recMsg.push(e.chatMsg)}},close:function(){console.log("socket已经关闭")},init:function(){var t={action:1,chatMsg:{senderId:this.$store.state.currentUser.id}};t.chatMsg.senderId=this.$store.state.currentUser.id,this.send(t)},sendMsg:function(t){if(t=t.replace("\n",""),t){var e={action:10,chatMsg:{senderId:null,groupId:null,msg:null}};e.chatMsg.senderId=this.$store.state.currentUser.id,e.chatMsg.groupId=this.$store.state.queryResult.id,e.chatMsg.msg=t.replace("\n",""),this.send(e),this.chatMsg=null}else this.chatMsg=null,alert("发送内容不能为空，请重新输入")}}},ht=vt,gt=(s("10b7"),Object(r["a"])(ht,mt,ft,!1,null,"22115dcf",null)),_t=gt.exports,Ct=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"content"},[s("div",{staticClass:"header"},[s("div",{staticClass:"backButton",on:{click:function(e){return t.$router.push("/main/groupchat")}}},[t._v("< Back")]),t._m(0)]),s("div",{staticClass:"groupInfo"},[s("div",{staticClass:"infoRow"},[t._v("群主："+t._s(t.masterName))]),s("div",{staticClass:"infoRow"},[t._v("群名："),s("input",{directives:[{name:"model",rawName:"v-model",value:t.groupSetting.name,expression:"groupSetting.name"}],attrs:{type:"text",size:"15",placeholder:this.groupSetting.name},domProps:{value:t.groupSetting.name},on:{input:function(e){e.target.composing||t.$set(t.groupSetting,"name",e.target.value)}}})]),s("div",{staticClass:"infoRow",staticStyle:{border:"none"}},[t._v("群介绍")]),s("div",{staticClass:"infoRow",staticStyle:{"margin-top":"5px",height:"100px"}},[s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.groupSetting.info,expression:"groupSetting.info"}],attrs:{placeholder:t.groupSetting.info},domProps:{value:t.groupSetting.info},on:{input:function(e){e.target.composing||t.$set(t.groupSetting,"info",e.target.value)}}})]),s("div",{staticClass:"infoRow save",domProps:{textContent:t._s(t.saveButton)},on:{click:t.saveInfo}}),s("div",{staticClass:"infoRow disband",domProps:{textContent:t._s(t.disbandButton)},on:{click:t.disbandGroup}})]),s("div",{staticClass:"groupMember"},[t._m(1),s("div",{staticClass:"memberBox"},t._l(t.memberList,(function(e){return t.memberList[0]?s("div",{staticClass:"member",on:{mouseenter:function(s){return t.showAction(e.id)},mouseleave:function(e){t.show=null}}},[s("span",{staticClass:"chara"},[t._v("["+t._s(2===e.groupId?"群主":1===e.groupId?"管理员":"群员")+"] ")]),s("span",{staticClass:"name"},[t._v(t._s(e.name))]),s("div",{directives:[{name:"show",rawName:"v-show",value:e.id===t.show,expression:"member.id === show"}],staticClass:"actionBox"},[s("span",{directives:[{name:"show",rawName:"v-show",value:2===t.currentRoleId&&0===e.groupId,expression:"currentRoleId === 2 && member.groupId === 0"}],staticClass:"setAdmin",on:{click:function(s){return t.setAdmin(e.id)}}},[t._v("设为管理员")]),s("span",{directives:[{name:"show",rawName:"v-show",value:2===t.currentRoleId&&1===e.groupId,expression:"currentRoleId === 2 && member.groupId === 1"}],staticClass:"removeAdmin",on:{click:function(s){return t.removeAdmin(e.id)}}},[t._v("取消管理员")]),s("span",{directives:[{name:"show",rawName:"v-show",value:t.currentRoleId>e.groupId,expression:"currentRoleId > member.groupId"}],staticClass:"removeMember",on:{click:function(s){return t.removeMember(e.id)}}},[t._v("移出群聊")])])]):t._e()})),0)])])},bt=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"title"},[s("span",[t._v("群设置")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"infoRow",staticStyle:{margin:"50px 0"}},[s("h2",[t._v("群成员")])])}],wt={name:"GroupSetting",data:function(){return{show:null,currentRoleId:null,saveButton:"保存",disbandButton:"解散该群",masterName:null,groupSetting:this.$store.state.queryResult,memberList:{id:null,name:null,nickname:null,gender:null,groupId:0}}},mounted:function(){var t=this;this.axios.get("/group/queryUserRole/"+this.groupSetting.id).then((function(e){t.currentRoleId=e.data})).catch((function(t){console.log(t.response.data)})),this.axios.get("/user/queryUser/"+this.groupSetting.masterId).then((function(e){t.masterName=e.data.name})).catch((function(t){console.log(t.response.data)})),this.axios.get("/group/members/"+this.groupSetting.id).then((function(e){t.memberList=e.data})).catch((function(t){console.log(t.response.data)}))},methods:{showAction:function(t){this.show=t},saveInfo:function(){var t=this;delete this.groupSetting.flag,delete this.groupSetting.createTime,this.axios.post("/group/changeGroupInfo",this.groupSetting).then((function(){t.saveButton="保存成功！",setTimeout((function(){t.axios.get("/user/group").then((function(e){t.$store.commit("setGroupList",e.data)})),Lt.replace("/main/groupchat")}),1e3)})).catch((function(t){alert(t.response.data.message)}))},setAdmin:function(t){var e=this;this.axios.post("/group/setUserManageRole/"+this.groupSetting.id+"/"+t).then((function(){e.$router.go(0)})).catch((function(t){console.log(t.response.data)}))},removeAdmin:function(t){var e=this;this.axios.post("/group/removeUserManageRole/"+this.groupSetting.id+"/"+t).then((function(){e.$router.go(0)})).catch((function(t){console.log(t.response.data)}))},removeMember:function(t){var e=this;this.axios.post("/group//removeGroupUser/"+this.groupSetting.id+"/"+t).then((function(){e.$router.go(0)})).catch((function(t){console.log(t.response.data)}))},disbandGroup:function(){var t=this;this.axios.post("/group/dissolute/"+this.groupSetting.id).then((function(){t.disbandButton="解散成功",t.axios.get("/user/group").then((function(e){t.$store.commit("setGroupList",e.data)})).catch((function(t){401===t.response.status&&Lt.replace("/welcome")})),setTimeout((function(){Lt.push("/main")}),1e3)})).catch((function(t){console.log(t.response.data)}))}}},xt=wt,kt=(s("64a4"),Object(r["a"])(xt,Ct,bt,!1,null,"1c4046de",null)),yt=kt.exports,$t=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"content"},[s("div",{staticClass:"header"},[s("div",{staticClass:"headerBar"}),s("div",{staticClass:"backButton",on:{click:function(e){return t.$router.push("/main/groupchat")}}},[t._v("< Back")]),t._m(0),s("div",{staticClass:"createWindow"},[s("div",{staticClass:"infoRow"},[t._v("群名称："),s("input",{directives:[{name:"model",rawName:"v-model",value:t.groupInfo.name,expression:"groupInfo.name"}],attrs:{type:"text"},domProps:{value:t.groupInfo.name},on:{input:function(e){e.target.composing||t.$set(t.groupInfo,"name",e.target.value)}}})]),s("div",{staticClass:"infoRow"},[t._v("群介绍："),s("input",{directives:[{name:"model",rawName:"v-model",value:t.groupInfo.info,expression:"groupInfo.info"}],attrs:{type:"text"},domProps:{value:t.groupInfo.info},on:{input:function(e){e.target.composing||t.$set(t.groupInfo,"info",e.target.value)}}})]),s("div",{staticClass:"infoRow submitButton",domProps:{textContent:t._s(t.submitButton)},on:{click:t.createGroup}})])])])},Rt=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"title"},[s("span",[t._v("创建群")])])}],Mt={router:Lt,data:function(){return{groupInfo:{name:null,info:null},submitButton:"提交"}},methods:{createGroup:function(){var t=this;this.axios.post("/group/create",this.groupInfo).then((function(){t.submitButton="创建成功！",t.axios.get("/user/group").then((function(e){t.$store.commit("setGroupList",e.data)})).catch((function(t){401===t.response.status&&Lt.replace("/welcome")})),setTimeout((function(){Lt.push("/main")}),1e3)})).catch((function(t){alert("参数错误！"),console.log(t.response.data)}))}}},It=Mt,Nt=(s("d00b"),Object(r["a"])(It,$t,Rt,!1,null,"2f077bfe",null)),St=Nt.exports;n["a"].use(p["a"]);var Bt=[{path:"/",redirect:"/welcome"},{path:"/welcome",component:_},{path:"/register",component:y},{path:"/main",component:S,children:[{path:"editinfo",component:j},{path:"searchuser",component:A},{path:"searchgroup",component:z},{path:"friendrequest",component:tt},{path:"friendchat",component:rt},{path:"friendinfo",component:pt},{path:"groupchat",component:_t},{path:"groupsetting",component:yt},{path:"creategroup",component:St}]}],Pt=new p["a"]({routes:Bt,mode:"history"}),qt=p["a"].prototype.push;p["a"].prototype.push=function(t){return qt.call(this,t).catch((function(t){return t}))};var Lt=Pt,Ot=s("2f62"),jt=s("bfa9");n["a"].use(Ot["a"]);var Tt=new jt["a"]({storage:window.sessionStorage}),Ut=new Ot["a"].Store({state:{friendList:[{groupId:0,groupName:"",users:[{id:0,name:"",nickname:"",gender:0,groupId:0}]}],groupList:[{id:0,name:"",masterId:0,info:"",flag:0,createTime:""}],currentTab:"好友",currentUser:null,queryResult:null,searchResult:null},mutations:{setCurrentTab:function(t,e){t.currentTab=e},setFriendList:function(t,e){t.friendList=e},setGroupList:function(t,e){t.groupList=e},setCurrentUser:function(t,e){t.currentUser=e},setQueryResult:function(t,e){t.queryResult=e},setSearchResult:function(t,e){t.searchResult=e}},actions:{},modules:{},plugins:[Tt.plugin]});n["a"].config.productionTip=!1,n["a"].prototype.axios=d.a,d.a.defaults.baseURL="http://localhost:8080",d.a.defaults.withCredentials=!0,new n["a"]({router:Lt,store:Ut,render:function(t){return t(u)}}).$mount("#app")},"5d43":function(t,e,s){"use strict";var n=s("158e"),a=s.n(n);a.a},"64a4":function(t,e,s){"use strict";var n=s("2a4b"),a=s.n(n);a.a},"65bd":function(t,e,s){"use strict";var n=s("55c6"),a=s.n(n);a.a},6976:function(t,e,s){"use strict";var n=s("0e90"),a=s.n(n);a.a},"782e":function(t,e,s){"use strict";var n=s("ef5f"),a=s.n(n);a.a},"7f8b":function(t,e,s){},"85ec":function(t,e,s){},"866a":function(t,e,s){},"906c":function(t,e,s){"use strict";var n=s("2111"),a=s.n(n);a.a},ca08:function(t,e,s){},d00b:function(t,e,s){"use strict";var n=s("0eb8"),a=s.n(n);a.a},dd28:function(t,e,s){"use strict";var n=s("126f"),a=s.n(n);a.a},dff8:function(t,e,s){"use strict";var n=s("866a"),a=s.n(n);a.a},ef5f:function(t,e,s){}});
//# sourceMappingURL=app.1f1f4275.js.map